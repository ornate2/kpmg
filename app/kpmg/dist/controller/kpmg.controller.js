sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/odata/v2/ODataModel","sap/m/MessageToast","sap/ui/model/json/JSONModel"],function(e,r,t,i){"use strict";return e.extend("kpmg.controller.kpmg",{onInit:function(){var e=new i({currentPage:1,limit:20,canNext:true,canPrevious:false});this.getView().setModel(e,"paginationModel")},onPressPredictButton:function(){var e=this;var r=this.getView();var o=r.byId("descriptionInput").getValue();var n=r.byId("serialNumberInput").getValue();var s=r.byId("serviceOrderCodesInput").getValue();var a=r.getModel();var c=new sap.m.BusyDialog;c.open();var d={description:o,serialNumber:n,serviceOrderCodes:s};var l=this.getView().getModel("paginationModel");var u=l.getProperty("/currentPage");var p=l.getProperty("/limit");var g=(u-1)*p;a.create("/Predict",d,{success:function(t){const o=JSON.parse(t.description);const n=Object.keys(o).map(e=>({instance:e,equipmentNumberSerialNumber:o[e]["Equipment Number/Serial Number"],errorDescription:o[e]["Error Description"],quantityUsed:o[e]["Quantity Used"],serviceOrderErrorCodesActivityNumbers:o[e]["Service Order Error Codes/Activity Numbers"],sparePartDescription:o[e]["Spare Part Description"],sparePartUsed:o[e]["Spare Part Used"],tasksUsed:o[e]["Tasks Used"]}));var s=n.slice(g,g+p);setTimeout(function(){c.close();var t=new i({predictions:s});r.setModel(t,"predictionModel");l.setProperty("/canNext",g+p<n.length);l.setProperty("/canPrevious",u>1);var o=e.getView().byId("panel1");o.setExpanded(!o.getExpanded())},3e3)},error:function(e){t.show("Error occurred while predicting.");c.close()}})},onPreviousPage:function(){var e=this.getView().getModel("paginationModel");var r=e.getProperty("/currentPage");if(r>1){e.setProperty("/currentPage",r-1);this.onPressPredictButton()}},onNextPage:function(){var e=this.getView().getModel("paginationModel");var r=e.getProperty("/currentPage");e.setProperty("/currentPage",r+1);this.onPressPredictButton()},onOpenDialog:function(){if(!this.pDialog){this.pDialog=this.loadFragment({name:"kpmg.fragments.PredictionResults"}).then(function(e){this.pDialog=e;e.open()}.bind(this)).catch(function(e){console.error("Error loading fragment:",e)})}else{this.pDialog.open()}},onCancelPress:function(){var e=this.getView().byId("helloDialog");if(e){e.close()}else{console.error("Dialog not found or not initialized properly.")}},onSubmitPress:function(){this.onOpenDialog()}})});
//# sourceMappingURL=kpmg.controller.js.map